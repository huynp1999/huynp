- hosts:
  - mon
  - osd
  - mgr

  become: true
  tasks:
  - name: Install packet
    yum:
      name: '{{item}}'
      state: present
    with_items:
    - epel-release
    - wget
    - git
    - python-setuptools
    - python-virtualenv

- hosts: mon
  become: True
  any_errors_fatal: true
  tasks:
    - name: Deploy monitor
      command: "ceph-deploy new {{item}}"
      with_items: hosts
    - name: Config ceph.conf
      template:
          src: templates/ceph.conf.j2
          dest: /home/ansibledeploy/my-cluster/ceph.conf

- hosts: mgr
  become: True
  any_errors_fatal: true
  command: "ceph-deploy mgr create {{item}}"
  with_items: hosts
#  roles:
#      - ceph-mgr

- hosts: osd
  become: True
  any_errors_fatal: true
  command: "ceph-deploy osd create --data {{item}}"
  with_items: devices
#  roles:
#      - ceph-osd


