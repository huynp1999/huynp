
- hosts: 
  any_errors_fatal: true
  tasks:
    - name: Add cluster
      command: "ceph-deploy new {{item}}"
      with_items: "{{ host }}"
    - name: Copy config
      template:
          src: templates/ceph.conf.j2
          dest: files/temp.conf
    - name: Apply ceph.conf
      shell: "cat files/temp.conf >> /etc/ceph/ceph.conf"

- hosts: mgr
  any_errors_fatal: true
  command: "ceph-deploy install --release nautilus {{item}}"
  with_items: "{{ host }}"
  with_items: hosts

- hosts: mgr
  any_errors_fatal: true
  command: "ceph-deploy mgr create {{item}}"
  with_items: "{{ host }}"
  with_items: hosts
#  roles:
#      - ceph-mgr

- hosts: osd
  any_errors_fatal: true
  command: "ceph-deploy osd create --data {{item}}"
  with_items: "{{ device }}"
#  roles:
#      - ceph-osd


